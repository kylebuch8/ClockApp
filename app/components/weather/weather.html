<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="weather-app">
    <style>

    :host {
        display: -webkit-flex;
        display: flex;
        -webkit-flex-direction: column;
        flex-direction: column;
        -webkit-align-items: center;
        align-items: center;
        -webkit-justify-content: center;
        justify-content: center;
    }

    </style>

    <template>
        <iron-ajax
            auto
            url="http://api.wunderground.com/api/237c499a64ba2cec/conditions/q/NC/Apex.json"
            handle-as="json"
            on-response="handleWeatherResponse"></iron-ajax>

        <span>{{location}}</span>
        <h1>{{currentTemp}}</h1>
        <img src$="{{icon}}">
    </template>
</dom-module>

<script>

    Polymer({
        is: 'weather-app',

        properties: {
            location: String,
            currentTemp: String,
            icon: String
        },

        handleWeatherResponse: function (event) {
            var data = event.detail.response;

            this.location = data.current_observation.display_location.full;
            this.currentTemp = Math.round(parseInt(data.current_observation.temp_f, 10));
            this.icon = data.current_observation.icon_url;
        }
    });

</script>
